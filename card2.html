<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö Flashcard App</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            color: #4f46e5;
            margin-bottom: 20px;
        }
        
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
        }
        
        .status-item {
            margin: 8px 0;
            font-size: 14px;
            display: flex;
            justify-content: space-between;
        }
        
        button {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: background 0.3s;
            margin: 10px 5px;
        }
        
        button:hover {
            background: #4338ca;
        }
        
        button:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
        }
        
        .btn-success {
            background: #10b981;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-danger {
            background: #ef4444;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .backup-section {
            margin-top: 30px;
            padding: 20px;
            background: #fffbeb;
            border: 1px solid #fde68a;
            border-radius: 8px;
        }
        
        code {
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        
        .logs {
            margin-top: 20px;
            padding: 15px;
            background: #0f172a;
            color: #e2e8f0;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin: 4px 0;
            padding: 4px;
            border-bottom: 1px solid #334155;
        }
        
        .log-success {
            color: #4ade80;
        }
        
        .log-error {
            color: #f87171;
        }
        
        .log-info {
            color: #60a5fa;
        }
        
        .progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            width: 0%;
            transition: width 0.5s;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö Flashcard App</h1>
        
        <div class="status">
            <h3>–°—Ç–∞—Ç—É—Å –¥–∞–Ω–Ω—ã—Ö:</h3>
            <div class="status-item">
                <span>–°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage:</span>
                <span id="old-data-status">‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω—ã</span>
            </div>
            <div class="status-item">
                <span>–ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏):</span>
                <span id="new-data-status">‚ùå –ù–µ—Ç</span>
            </div>
            <div class="status-item">
                <span>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–ª–æ–¥:</span>
                <span id="decks-count">0</span>
            </div>
            <div class="status-item">
                <span>–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤:</span>
                <span id="words-count">0</span>
            </div>
            <div class="status-item">
                <span>–û–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö (–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ):</span>
                <span id="data-size">0 KB</span>
            </div>
        </div>
        
        <div id="progress-bar" class="progress-bar" style="display: none;">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        
        <div class="logs" id="logs">
            <!-- –õ–æ–≥–∏ –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
        
        <div>
            <button onclick="analyzeData()" id="analyze-btn">üîç –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            <button onclick="backupOldData()" id="backup-btn" disabled>üíæ –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é</button>
            <button onclick="migrateData()" id="migrate-btn" class="btn-success" disabled>üîÑ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            <button onclick="restoreFromBackup()" id="restore-btn" class="btn-danger" disabled>‚Ü©Ô∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏</button>
            <button onclick="clearAllData()" id="clear-btn" class="btn-danger" style="float: right;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ</button>
        </div>
        
        <div class="backup-section">
            <h3>–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</h3>
            <p>–ü–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π <strong>–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é</strong>!</p>
            <p>–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ localStorage –ø–æ–¥ –∫–ª—é—á–æ–º <code>flashcardAppData_backup_old</code></p>
            <p>–ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –ø–æ–¥ –∫–ª—é—á–æ–º <code>flashcardAppData_new</code></p>
        </div>
    </div>

    <script>
        let oldData = null;
        let newData = null;
        let logs = [];
        
        function log(type, message) {
            const timestamp = new Date().toLocaleTimeString();
            const entry = { type, message, timestamp };
            logs.push(entry);
            
            const logElement = document.createElement('div');
            logElement.className = `log-entry log-${type}`;
            logElement.textContent = `[${timestamp}] ${message}`;
            document.getElementById('logs').appendChild(logElement);
            document.getElementById('logs').scrollTop = document.getElementById('logs').scrollHeight;
        }
        
        function updateProgress(percent) {
            const progressBar = document.getElementById('progress-bar');
            const progressFill = document.getElementById('progress-fill');
            
            progressBar.style.display = 'block';
            progressFill.style.width = `${percent}%`;
        }
        
        function analyzeData() {
            logs = [];
            document.getElementById('logs').innerHTML = '';
            
            try {
                const data = localStorage.getItem('flashcardAppData');
                if (!data) {
                    log('error', '–°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ localStorage');
                    return;
                }
                
                oldData = JSON.parse(data);
                log('success', `–ù–∞–π–¥–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ä–∞–∑–º–µ—Ä: ${(data.length / 1024).toFixed(2)} KB`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                document.getElementById('old-data-status').textContent = '‚úÖ –ù–∞–π–¥–µ–Ω—ã';
                document.getElementById('old-data-status').style.color = '#10b981';
                
                // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const decksCount = oldData.decks ? oldData.decks.length : 0;
                let wordsCount = 0;
                
                if (oldData.decks) {
                    oldData.decks.forEach(deck => {
                        if (deck.words) {
                            wordsCount += deck.words.length;
                        }
                    });
                }
                
                document.getElementById('decks-count').textContent = decksCount;
                document.getElementById('words-count').textContent = wordsCount;
                document.getElementById('data-size').textContent = `${(data.length / 1024).toFixed(2)} KB`;
                
                // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–ª–æ–≤–∞
                if (decksCount > 0 && wordsCount > 0) {
                    const firstDeck = oldData.decks[0];
                    if (firstDeck.words && firstDeck.words.length > 0) {
                        const firstWord = firstDeck.words[0];
                        const isOldFormat = typeof firstWord === 'object' && 'eng' in firstWord;
                        log('info', `–§–æ—Ä–º–∞—Ç —Å–ª–æ–≤–∞: ${isOldFormat ? '–°—Ç–∞—Ä—ã–π (–æ–±—ä–µ–∫—Ç)' : '–ù–æ–≤—ã–π (–º–∞—Å—Å–∏–≤)'}`);
                        log('info', `–ü—Ä–∏–º–µ—Ä —Å–ª–æ–≤–∞: ${JSON.stringify(firstWord).substring(0, 100)}...`);
                        
                        // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä ID
                        if (firstWord.id) {
                            const idLength = firstWord.id.length;
                            log('info', `–î–ª–∏–Ω–∞ ID: ${idLength} —Å–∏–º–≤–æ–ª–æ–≤`);
                        }
                    }
                }
                
                // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏
                document.getElementById('backup-btn').disabled = false;
                document.getElementById('migrate-btn').disabled = false;
                log('success', '–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω');
                
            } catch (error) {
                log('error', `–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –¥–∞–Ω–Ω—ã—Ö: ${error.message}`);
            }
        }
        
        function backupOldData() {
            try {
                const backupKey = `flashcardAppData_backup_old_${Date.now()}`;
                localStorage.setItem(backupKey, JSON.stringify(oldData));
                localStorage.setItem('flashcardAppData_backup_latest', backupKey);
                
                log('success', `–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–æ–∑–¥–∞–Ω–∞: ${backupKey}`);
                log('info', '–°—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. –ú–æ–∂–Ω–æ –ø—Ä–∏—Å—Ç—É–ø–∞—Ç—å –∫ –º–∏–≥—Ä–∞—Ü–∏–∏.');
                
                document.getElementById('restore-btn').disabled = false;
                
            } catch (error) {
                log('error', `–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏: ${error.message}`);
            }
        }
        
        function generateShortId() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }
        
        function migrateData() {
            if (!oldData) {
                log('error', '–ù–µ—Ç —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏');
                return;
            }
            
            try {
                log('info', '–ù–∞—á–∞–ª–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö...');
                updateProgress(10);
                
                // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
                newData = {
                    decks: [],
                    folders: oldData.folders || [],
                    settings: oldData.settings || { shuffle: false, reverse: false, autoSpeak: true },
                    studyProgress: oldData.studyProgress || {}
                };
                
                updateProgress(20);
                
                // –ú–∏–≥—Ä–∏—Ä—É–µ–º –∫–æ–ª–æ–¥—ã
                if (oldData.decks) {
                    const totalDecks = oldData.decks.length;
                    
                    oldData.decks.forEach((deck, deckIndex) => {
                        const newDeck = {
                            id: deck.id,
                            name: deck.name,
                            folderId: deck.folderId || null,
                            createdAt: deck.createdAt || new Date().toISOString(),
                            iterations: deck.iterations || [],
                            stats: deck.stats || { totalStudied: 0, lastStudied: null },
                            words: [] // –ó–¥–µ—Å—å –±—É–¥—É—Ç —Å–ª–æ–≤–∞ –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
                        };
                        
                        // –ú–∏–≥—Ä–∏—Ä—É–µ–º —Å–ª–æ–≤–∞
                        if (deck.words && deck.words.length > 0) {
                            const idMap = {}; // –ö–∞—Ä—Ç–∞ —Å—Ç–∞—Ä—ã—Ö ID -> –Ω–æ–≤—ã—Ö ID
                            
                            deck.words.forEach((word, wordIndex) => {
                                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ—Ä–æ—Ç–∫–∏–π ID
                                const newId = generateShortId();
                                
                                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
                                if (word.id) {
                                    idMap[word.id] = newId;
                                }
                                
                                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å–ª–æ–≤–æ –≤ –Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç: [eng, rus, index, id]
                                const newWord = [
                                    word.eng || '',
                                    word.rus || '',
                                    wordIndex,
                                    newId
                                ];
                                
                                newDeck.words.push(newWord);
                            });
                            
                            // –û–±–Ω–æ–≤–ª—è–µ–º ID –≤ –∏—Ç–µ—Ä–∞—Ü–∏—è—Ö
                            if (newDeck.iterations && newDeck.iterations.length > 0) {
                                newDeck.iterations.forEach(iteration => {
                                    if (iteration.knownWords) {
                                        iteration.knownWords = iteration.knownWords.map(oldId => idMap[oldId] || oldId);
                                    }
                                    if (iteration.unknownWords) {
                                        iteration.unknownWords = iteration.unknownWords.map(oldId => idMap[oldId] || oldId);
                                    }
                                });
                            }
                        }
                        
                        newData.decks.push(newDeck);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                        const progress = 20 + ((deckIndex + 1) / totalDecks) * 50;
                        updateProgress(progress);
                    });
                }
                
                updateProgress(80);
                
                // –ú–∏–≥—Ä–∏—Ä—É–µ–º studyProgress
                if (newData.studyProgress) {
                    Object.keys(newData.studyProgress).forEach(key => {
                        const progress = newData.studyProgress[key];
                        
                        // –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å sessionWords –∏ knownWords/unknownWords
                        // –ù–æ –¥–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–∞ –∫–∞—Ä—Ç–∞ –≤—Å–µ—Ö ID –∏–∑ –≤—Å–µ—Ö –∫–æ–ª–æ–¥
                        // –ü–æ–∫–∞ –ø—Ä–æ–ø—É—Å—Ç–∏–º —ç—Ç–æ—Ç —à–∞–≥, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ —Å–ª–æ–∂–Ω–µ–µ
                        // –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ—á–∏—Å—Ç–∏–º studyProgress, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
                        delete newData.studyProgress[key];
                    });
                    
                    // –û—á–∏—â–∞–µ–º studyProgress –ø–æ–ª–Ω–æ—Å—Ç—å—é, —Ç–∞–∫ –∫–∞–∫ –º–∏–≥—Ä–∞—Ü–∏—è —Å–ª–æ–∂–Ω–∞
                    newData.studyProgress = {};
                    log('info', '–ü—Ä–æ–≥—Ä–µ—Å—Å –∏–∑—É—á–µ–Ω–∏—è –æ—á–∏—â–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ)');
                }
                
                updateProgress(90);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
                const newDataKey = 'flashcardAppData_new';
                localStorage.setItem(newDataKey, JSON.stringify(newData));
                
                updateProgress(100);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                document.getElementById('new-data-status').textContent = '‚úÖ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã';
                document.getElementById('new-data-status').style.color = '#10b981';
                
                // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const newDataStr = JSON.stringify(newData);
                const oldDataStr = JSON.stringify(oldData);
                const sizeReduction = ((oldDataStr.length - newDataStr.length) / oldDataStr.length * 100).toFixed(1);
                
                log('success', `–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!`);
                log('info', `–°—Ç–∞—Ä—ã–π —Ä–∞–∑–º–µ—Ä: ${(oldDataStr.length / 1024).toFixed(2)} KB`);
                log('info', `–ù–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: ${(newDataStr.length / 1024).toFixed(2)} KB`);
                log('success', `–≠–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞: ${sizeReduction}%`);
                
                // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–º–µ—Ä —Å–ª–æ–≤–∞
                if (newData.decks.length > 0 && newData.decks[0].words.length > 0) {
                    const sampleWord = newData.decks[0].words[0];
                    log('info', `–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–ª–æ–≤–∞: ${JSON.stringify(sampleWord)}`);
                    log('info', `–î–ª–∏–Ω–∞ –Ω–æ–≤–æ–≥–æ ID: ${sampleWord[3].length} —Å–∏–º–≤–æ–ª–æ–≤`);
                }
                
                // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
                log('info', '='.repeat(50));
                log('info', '–ò–ù–°–¢–†–£–ö–¶–ò–Ø:');
                log('info', '1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–ª—é—á–∞ flashcardAppData_new');
                log('info', '2. –í –Ω–æ–≤–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ flashcardAppData');
                log('info', '3. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥–æ–π –Ω–∏–∂–µ');
                
            } catch (error) {
                log('error', `–û—à–∏–±–∫–∞ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏: ${error.message}`);
                updateProgress(0);
            }
        }
        
        function restoreFromBackup() {
            try {
                const backupKey = localStorage.getItem('flashcardAppData_backup_latest');
                if (!backupKey) {
                    log('error', '–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    return;
                }
                
                const backupData = localStorage.getItem(backupKey);
                if (!backupData) {
                    log('error', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é');
                    return;
                }
                
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
                localStorage.setItem('flashcardAppData', backupData);
                oldData = JSON.parse(backupData);
                
                log('success', '–î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
                analyzeData();
                
            } catch (error) {
                log('error', `–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏: ${error.message}`);
            }
        }
        
        function clearAllData() {
            if (!confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ —É–¥–∞–ª–∏—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                return;
            }
            
            try {
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ –∫–ª—é—á–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
                const keysToRemove = [];
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.includes('flashcardAppData')) {
                        keysToRemove.push(key);
                    }
                }
                
                keysToRemove.forEach(key => {
                    localStorage.removeItem(key);
                    log('info', `–£–¥–∞–ª–µ–Ω –∫–ª—é—á: ${key}`);
                });
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                oldData = null;
                newData = null;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI
                document.getElementById('old-data-status').textContent = '‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω—ã';
                document.getElementById('new-data-status').textContent = '‚ùå –ù–µ—Ç';
                document.getElementById('decks-count').textContent = '0';
                document.getElementById('words-count').textContent = '0';
                document.getElementById('data-size').textContent = '0 KB';
                
                document.getElementById('backup-btn').disabled = true;
                document.getElementById('migrate-btn').disabled = true;
                document.getElementById('restore-btn').disabled = true;
                
                log('success', '–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã');
                
            } catch (error) {
                log('error', `–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö: ${error.message}`);
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            log('info', '–ú–∏–≥—Ä–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö Flashcard App –∑–∞–≥—Ä—É–∂–µ–Ω');
            analyzeData();
        });
    </script>
</body>
</html>
