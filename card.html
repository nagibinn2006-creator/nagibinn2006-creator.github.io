<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Карточки для запоминания слов</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 2.2em;
        }
        
        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px dashed #dee2e6;
        }
        
        textarea {
            width: 100%;
            height: 150px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
            background: white;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #4a6fa5;
            color: white;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .control-btn {
            background: #3498db;
        }
        
        .know-btn {
            background: #2ecc71;
        }
        
        .dont-know-btn {
            background: #e74c3c;
        }
        
        .settings-btn {
            background: #9b59b6;
        }
        
        .card-container {
            perspective: 1000px;
            margin: 30px 0;
            display: none;
        }
        
        .card {
            width: 100%;
            height: 300px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s;
            cursor: pointer;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .card.flipped {
            transform: rotateY(180deg);
        }
        
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
        }
        
        .card-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .card-back {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            transform: rotateY(180deg);
        }
        
        .word {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .translation {
            font-size: 2em;
            text-align: center;
            color: #fff;
        }
        
        .hint {
            font-size: 1em;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 20px;
            font-style: italic;
        }
        
        .progress {
            margin-top: 20px;
            text-align: center;
            font-size: 1.1em;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #ecf0f1;
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #2ecc71, #1abc9c);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1em;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .settings {
            display: none;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .setting-item {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .setting-item label {
            margin-left: 10px;
            font-size: 1.1em;
        }
        
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
            display: none;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Карточки для запоминания слов</h1>
        
        <div class="input-section">
            <textarea id="wordsInput" placeholder="Введите слова в формате: английское слово:перевод (каждое слово на новой строке)&#10;Пример:&#10;time:время&#10;year:год&#10;people:люди"></textarea>
            
            <div class="button-group">
                <button id="startBtn" class="start-btn">Начать обучение</button>
                <button id="saveProgressBtn" class="settings-btn">Сохранить прогресс</button>
                <button id="resetProgressBtn" class="settings-btn">Сбросить прогресс</button>
                <button id="showSettingsBtn" class="settings-btn">Настройки</button>
            </div>
        </div>
        
        <div class="settings" id="settingsPanel">
            <h3>Настройки</h3>
            <div class="setting-item">
                <input type="checkbox" id="shuffleCards">
                <label for="shuffleCards">Перемешивать карточки</label>
            </div>
            <div class="setting-item">
                <input type="checkbox" id="showTranslationFirst">
                <label for="showTranslationFirst">Показывать перевод сначала</label>
            </div>
            <div class="setting-item">
                <input type="checkbox" id="autoNextCard">
                <label for="autoNextCard">Автоматически переходить к следующей карточке</label>
            </div>
            <div class="button-group">
                <button id="saveSettingsBtn" class="settings-btn">Сохранить настройки</button>
            </div>
        </div>
        
        <div id="statusMessage" class="status"></div>
        
        <div class="card-container" id="cardContainer">
            <div class="card" id="card">
                <div class="card-front">
                    <div class="word" id="cardFront">Слово</div>
                    <div class="hint">Нажмите на карточку, чтобы перевернуть</div>
                </div>
                <div class="card-back">
                    <div class="translation" id="cardBack">Перевод</div>
                    <div class="hint">Нажмите на карточку, чтобы вернуться</div>
                </div>
            </div>
            
            <div class="progress">
                <div id="progressText">Карточка 1 из 10</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            
            <div class="button-group">
                <button id="prevBtn" class="control-btn">← Назад</button>
                <button id="flipCardBtn" class="control-btn">Перевернуть</button>
                <button id="knowBtn" class="know-btn">Знаю ✓</button>
                <button id="dontKnowBtn" class="dont-know-btn">Не знаю ✗</button>
                <button id="nextBtn" class="control-btn">Вперед →</button>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <div>Всего слов</div>
                    <div class="stat-value" id="totalWords">0</div>
                </div>
                <div class="stat-item">
                    <div>Осталось</div>
                    <div class="stat-value" id="remainingWords">0</div>
                </div>
                <div class="stat-item">
                    <div>Правильно</div>
                    <div class="stat-value" id="knownWords">0</div>
                </div>
                <div class="stat-item">
                    <div>Ошибок</div>
                    <div class="stat-value" id="unknownWords">0</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class FlashcardApp {
            constructor() {
                this.cards = [];
                this.currentCardIndex = 0;
                this.knownCards = new Set();
                this.unknownCards = new Set();
                this.settings = {
                    shuffle: false,
                    showTranslationFirst: false,
                    autoNextCard: false
                };
                this.isCardFlipped = false;
                this.initialized = false;
                
                this.initElements();
                this.loadSettings();
                this.loadProgress();
                this.bindEvents();
            }
            
            initElements() {
                // Основные элементы
                this.wordsInput = document.getElementById('wordsInput');
                this.startBtn = document.getElementById('startBtn');
                this.saveProgressBtn = document.getElementById('saveProgressBtn');
                this.resetProgressBtn = document.getElementById('resetProgressBtn');
                this.showSettingsBtn = document.getElementById('showSettingsBtn');
                this.saveSettingsBtn = document.getElementById('saveSettingsBtn');
                
                // Настройки
                this.settingsPanel = document.getElementById('settingsPanel');
                this.shuffleCards = document.getElementById('shuffleCards');
                this.showTranslationFirst = document.getElementById('showTranslationFirst');
                this.autoNextCard = document.getElementById('autoNextCard');
                
                // Карточки
                this.cardContainer = document.getElementById('cardContainer');
                this.card = document.getElementById('card');
                this.cardFront = document.getElementById('cardFront');
                this.cardBack = document.getElementById('cardBack');
                
                // Кнопки управления
                this.prevBtn = document.getElementById('prevBtn');
                this.nextBtn = document.getElementById('nextBtn');
                this.flipCardBtn = document.getElementById('flipCardBtn');
                this.knowBtn = document.getElementById('knowBtn');
                this.dontKnowBtn = document.getElementById('dontKnowBtn');
                
                // Статистика
                this.progressText = document.getElementById('progressText');
                this.progressFill = document.getElementById('progressFill');
                this.totalWords = document.getElementById('totalWords');
                this.remainingWords = document.getElementById('remainingWords');
                this.knownWords = document.getElementById('knownWords');
                this.unknownWords = document.getElementById('unknownWords');
                
                // Сообщения
                this.statusMessage = document.getElementById('statusMessage');
            }
            
            bindEvents() {
                // Кнопки управления
                this.startBtn.addEventListener('click', () => this.startLearning());
                this.saveProgressBtn.addEventListener('click', () => this.saveProgress());
                this.resetProgressBtn.addEventListener('click', () => this.resetProgress());
                this.showSettingsBtn.addEventListener('click', () => this.toggleSettings());
                this.saveSettingsBtn.addEventListener('click', () => this.saveSettings());
                
                // Управление карточками
                this.card.addEventListener('click', () => this.flipCard());
                this.flipCardBtn.addEventListener('click', () => this.flipCard());
                this.prevBtn.addEventListener('click', () => this.prevCard());
                this.nextBtn.addEventListener('click', () => this.nextCard());
                this.knowBtn.addEventListener('click', () => this.markAsKnown());
                this.dontKnowBtn.addEventListener('click', () => this.markAsUnknown());
                
                // Клавиши клавиатуры
                document.addEventListener('keydown', (e) => this.handleKeyPress(e));
            }
            
            parseWords(text) {
                const lines = text.split('\n').filter(line => line.trim() !== '');
                const cards = [];
                
                for (const line of lines) {
                    const parts = line.split(':');
                    if (parts.length >= 2) {
                        const word = parts[0].trim();
                        const translation = parts.slice(1).join(':').trim();
                        if (word && translation) {
                            cards.push({
                                word,
                                translation,
                                id: `${word}:${translation}`
                            });
                        }
                    }
                }
                
                return cards;
            }
            
            startLearning() {
                const text = this.wordsInput.value.trim();
                if (!text) {
                    this.showMessage('Введите слова для начала обучения', 'error');
                    return;
                }
                
                this.cards = this.parseWords(text);
                if (this.cards.length === 0) {
                    this.showMessage('Не найдено слов в правильном формате', 'error');
                    return;
                }
                
                // Сброс прогресса при новом наборе слов
                this.knownCards.clear();
                this.unknownCards.clear();
                this.currentCardIndex = 0;
                
                // Применение настроек
                if (this.settings.shuffle) {
                    this.shuffleCardsArray();
                }
                
                this.initialized = true;
                this.cardContainer.style.display = 'block';
                this.updateCard();
                this.updateStats();
                this.saveProgress();
                
                this.showMessage(`Начато изучение ${this.cards.length} слов`, 'success');
            }
            
            shuffleCardsArray() {
                for (let i = this.cards.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [this.cards[i], this.cards[j]] = [this.cards[j], this.cards[i]];
                }
            }
            
            updateCard() {
                if (!this.initialized || this.cards.length === 0) return;
                
                const card = this.cards[this.currentCardIndex];
                const isKnown = this.knownCards.has(card.id);
                const isUnknown = this.unknownCards.has(card.id);
                
                // Сброс состояния переворота
                this.isCardFlipped = false;
                this.card.classList.remove('flipped');
                
                // Установка содержимого в зависимости от настроек
                if (this.settings.showTranslationFirst) {
                    this.cardFront.textContent = card.translation;
                    this.cardBack.textContent = card.word;
                } else {
                    this.cardFront.textContent = card.word;
                    this.cardBack.textContent = card.translation;
                }
                
                // Обновление прогресса
                const progress = ((this.currentCardIndex + 1) / this.cards.length) * 100;
                this.progressText.textContent = `Карточка ${this.currentCardIndex + 1} из ${this.cards.length}`;
                this.progressFill.style.width = `${progress}%`;
                
                // Обновление цвета карточки в зависимости от статуса
                if (isKnown) {
                    this.card.style.background = 'linear-gradient(135deg, #2ecc71, #27ae60)';
                } else if (isUnknown) {
                    this.card.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                } else {
                    this.card.style.background = '';
                }
            }
            
            flipCard() {
                this.isCardFlipped = !this.isCardFlipped;
                if (this.isCardFlipped) {
                    this.card.classList.add('flipped');
                } else {
                    this.card.classList.remove('flipped');
                }
            }
            
            prevCard() {
                if (this.currentCardIndex > 0) {
                    this.currentCardIndex--;
                    this.updateCard();
                }
            }
            
            nextCard() {
                if (this.currentCardIndex < this.cards.length - 1) {
                    this.currentCardIndex++;
                    this.updateCard();
                }
            }
            
            markAsKnown() {
                if (!this.initialized || this.cards.length === 0) return;
                
                const card = this.cards[this.currentCardIndex];
                this.knownCards.add(card.id);
                this.unknownCards.delete(card.id);
                
                this.updateStats();
                this.saveProgress();
                
                if (this.settings.autoNextCard && this.currentCardIndex < this.cards.length - 1) {
                    setTimeout(() => this.nextCard(), 300);
                }
            }
            
            markAsUnknown() {
                if (!this.initialized || this.cards.length === 0) return;
                
                const card = this.cards[this.currentCardIndex];
                this.unknownCards.add(card.id);
                this.knownCards.delete(card.id);
                
                this.updateStats();
                this.saveProgress();
                
                if (this.settings.autoNextCard && this.currentCardIndex < this.cards.length - 1) {
                    setTimeout(() => this.nextCard(), 300);
                }
            }
            
            updateStats() {
                this.totalWords.textContent = this.cards.length;
                this.remainingWords.textContent = this.cards.length - (this.knownCards.size + this.unknownCards.size);
                this.knownWords.textContent = this.knownCards.size;
                this.unknownWords.textContent = this.unknownCards.size;
            }
            
            toggleSettings() {
                this.settingsPanel.style.display = 
                    this.settingsPanel.style.display === 'block' ? 'none' : 'block';
            }
            
            saveSettings() {
                this.settings = {
                    shuffle: this.shuffleCards.checked,
                    showTranslationFirst: this.showTranslationFirst.checked,
                    autoNextCard: this.autoNextCard.checked
                };
                
                try {
                    localStorage.setItem('flashcardSettings', JSON.stringify(this.settings));
                    this.showMessage('Настройки сохранены', 'success');
                    
                    // Применить изменения, если обучение уже начато
                    if (this.initialized && this.settings.shuffle) {
                        this.shuffleCardsArray();
                        this.currentCardIndex = 0;
                        this.updateCard();
                    }
                } catch (e) {
                    this.showMessage('Ошибка сохранения настроек', 'error');
                }
            }
            
            loadSettings() {
                try {
                    const saved = localStorage.getItem('flashcardSettings');
                    if (saved) {
                        this.settings = JSON.parse(saved);
                        this.shuffleCards.checked = this.settings.shuffle;
                        this.showTranslationFirst.checked = this.settings.showTranslationFirst;
                        this.autoNextCard.checked = this.settings.autoNextCard;
                    }
                } catch (e) {
                    console.warn('Не удалось загрузить настройки');
                }
            }
            
            saveProgress() {
                if (!this.initialized) return;
                
                const progress = {
                    cards: this.cards,
                    currentCardIndex: this.currentCardIndex,
                    knownCards: Array.from(this.knownCards),
                    unknownCards: Array.from(this.unknownCards),
                    lastUpdated: new Date().toISOString()
                };
                
                try {
                    localStorage.setItem('flashcardProgress', JSON.stringify(progress));
                    this.showMessage('Прогресс сохранен', 'success');
                } catch (e) {
                    this.showMessage('Ошибка сохранения прогресса', 'error');
                }
            }
            
            loadProgress() {
                try {
                    const saved = localStorage.getItem('flashcardProgress');
                    if (saved) {
                        const progress = JSON.parse(saved);
                        
                        // Загружаем прогресс только если есть карточки
                        if (progress.cards && progress.cards.length > 0) {
                            this.cards = progress.cards;
                            this.currentCardIndex = progress.currentCardIndex || 0;
                            this.knownCards = new Set(progress.knownCards || []);
                            this.unknownCards = new Set(progress.unknownCards || []);
                            this.initialized = true;
                            
                            // Автоматически показываем карточки если есть прогресс
                            this.cardContainer.style.display = 'block';
                            this.updateCard();
                            this.updateStats();
                            
                            this.showMessage('Прогресс загружен', 'success');
                        }
                    }
                } catch (e) {
                    console.warn('Не удалось загрузить прогресс');
                }
            }
            
            resetProgress() {
                if (confirm('Вы уверены, что хотите сбросить весь прогресс?')) {
                    this.knownCards.clear();
                    this.unknownCards.clear();
                    this.currentCardIndex = 0;
                    
                    if (this.initialized) {
                        this.updateCard();
                        this.updateStats();
                    }
                    
                    try {
                        localStorage.removeItem('flashcardProgress');
                        this.showMessage('Прогресс сброшен', 'success');
                    } catch (e) {
                        this.showMessage('Ошибка сброса прогресса', 'error');
                    }
                }
            }
            
            handleKeyPress(e) {
                if (!this.initialized) return;
                
                switch(e.key) {
                    case 'ArrowLeft':
                        e.preventDefault();
                        this.prevCard();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        this.nextCard();
                        break;
                    case ' ':
                    case 'Enter':
                        e.preventDefault();
                        this.flipCard();
                        break;
                    case '1':
                    case 'y': // Yes
                        e.preventDefault();
                        this.markAsKnown();
                        break;
                    case '2':
                    case 'n': // No
                        e.preventDefault();
                        this.markAsUnknown();
                        break;
                }
            }
            
            showMessage(text, type) {
                this.statusMessage.textContent = text;
                this.statusMessage.className = `status ${type}`;
                this.statusMessage.style.display = 'block';
                
                setTimeout(() => {
                    this.statusMessage.style.display = 'none';
                }, 3000);
            }
        }
        
        // Инициализация приложения при загрузке страницы
        document.addEventListener('DOMContentLoaded', () => {
            window.flashcardApp = new FlashcardApp();
        });
    </script>
</body>
</html>
